# Festin - Product Requirements Document (PRD)

## 📌 프로젝트 개요

### 기본 정보
- **프로젝트명**: Festin
- **목적**: 대학 축제 부스 대기열 관리 시스템
- **기간**: 8주 (2024.11 ~ 2025.01)
- **팀**: 백엔드 1인 개발

---

## 🎯 문제 정의

### 해결하려는 문제
대학 축제에서 인기 부스의 긴 대기 줄로 인한 불편함을 해소하고, 효율적인 대기열 관리를 통해 사용자 경험을 개선합니다.

### 타겟 사용자
- **일반 사용자**: 축제 방문자 (대기 등록, 순번 확인)
- **부스 스태프**: 부스 운영진 (호출 관리, 입장 확인)

---

## 💡 핵심 가치

1. **실시간성**: 사용자가 현재 순번을 실시간으로 확인
2. **편의성**: 줄을 서지 않고 자유롭게 축제 즐기기
3. **공정성**: 선착순 기반의 투명한 대기열 관리
4. **효율성**: 부스 운영진의 효율적인 호출 관리
5. **신뢰성**: 알림 유실 방지 및 안정적인 서비스 제공

---

## 📋 기능 요구사항

### 1. 대기 등록
- 사용자가 원하는 부스에 대기 등록

**요구사항**:
- 사용자는 최대 2개 부스까지 동시 대기 가능
- 같은 부스에 중복 등록 불가
- 당일 내 같은 부스 재등록 불가 (멱등성)
- 등록 즉시 현재 순번 및 예상 대기 시간 확인 가능
- 푸시 알림 수신을 위한 토큰 저장

**제약사항**:
- 최대 2개 부스 제한으로 공정한 기회 보장
- 부스가 운영 중일 때만 등록 가능

---

### 2. 순번 조회
**목적**: 사용자가 실시간으로 자신의 대기 순번 확인

**요구사항**:
- 사용자 앱에서 주기적으로 순번 갱신 (폴링)
- 순번에 따라 갱신 주기 자동 조정 (동적 폴링)
- 전체 대기자 수 및 예상 대기 시간 표시

**갱신 주기 가이드**:
- 순번이 앞쪽: 짧은 주기 (실시간성 중요)
- 순번이 뒤쪽: 긴 주기 (서버 부하 최소화)

---

### 3. 대기 취소
**목적**: 사용자가 원하지 않으면 대기 취소 가능

**요구사항**:
- "대기 취소" 버튼 클릭 시 즉시 대기열에서 제거
- 취소 후 다른 부스 등록 가능 (최대 2개 제한 내)

---

### 4. 호출 알림
**목적**: 스태프가 다음 대기자를 호출하고 사용자에게 알림

**요구사항**:
- 스태프가 "다음 사람 호출" 버튼 클릭
- 시스템이 대기열 순서대로 1명 자동 선택
- 호출 조건: 부스 정원에 여유가 있어야 함
- 호출된 사용자에게 즉시 푸시 알림 발송
- 호출 시점부터 이력 영구 저장 (통계/분석용)

**신뢰성 요구사항**:
- 알림 발송 실패 시 자동 재시도 (최대 3회)
- 네트워크 장애 시에도 알림 유실 방지
- 메시지 큐를 통한 비동기 처리

---

### 5. 입장 확인
**목적**: 스태프가 실제 사용자 도착 확인

**요구사항**:
- 스태프가 사용자 확인 후 "입장 확인" 버튼 클릭
- 호출 후 일정 시간 내 미입장 시 자동 노쇼 처리
- 노쇼 처리 시 대기열에서 영구 제거

**노쇼 정책**:
- 타임아웃: 5분 (빠른 회전율 확보)
- 다른 대기자 배려 및 효율적인 운영

---

### 6. 체험 완료
**목적**: 사용자 체험 종료 후 부스 정원 갱신

**요구사항**:
- 스태프가 "완료" 버튼 클릭
- 부스 정원 1 감소 (다음 사람 호출 가능)
- 완료 통계에 반영

---

### 7. 부스 정원 관리
**목적**: 부스별 수용 인원 실시간 관리

**요구사항**:
- 부스별 최대 정원 설정
- 현재 입장 인원 실시간 표시
- 정원 초과 시 호출 불가
- 입장/퇴장 시 즉시 정원 갱신 (동시성 제어)

---

## 📊 비기능 요구사항

### 성능
- **동시 접속**: 5,000명 처리 가능
- **처리량**: 1,000 TPS (Transactions Per Second)
- **응답 시간**:
  - 대기 등록 API: 100ms 이내
  - 순번 조회 API: 50ms 이내

### 가용성
- **목표**: 99.9% 이상
- **장애 대응**:
  - 캐시 장애 시 대기 등록 불가
  - 알림 서비스 장애 시에도 알림 유실 방지 (메시지 큐)

### 확장성
- **부스 수**: 100개까지 확장 가능
- **대기자**: 1,000명/부스까지 처리
- **메모리**: 효율적인 캐시 관리

### 보안
- **인증**: JWT 기반 사용자 인증
- **API 보호**: Rate Limiting (사용자당 10 req/sec)
- **멱등성**: 중복 요청 방지 (24시간 TTL)

---

## 🚫 제약사항

### 비즈니스 제약
1. **최대 2개 부스 제한**
  - 이유: 공정한 기회 제공 및 독점 방지

2. **노쇼 타임아웃 5분**
  - 이유: 빠른 회전율 확보 및 다른 대기자 배려

3. **당일 중복 등록 방지**
  - 이유: 멱등성 보장 (24시간 TTL)
  - 다음날은 새로 등록 가능

4. **알림 유실 방지**
  - 이유: 사용자 경험 저해 방지
  - 메시지 큐를 통한 비동기 처리 및 자동 재시도

5. **부스 정원 실시간 관리**
  - 이유: 정원 초과 방지
  - 동시성 제어를 통한 안정성 확보

### 기술적 제약
1. **대기 중 데이터는 캐시 Only**
  - 이유: 빠른 조회 및 수정
  - 호출 시점부터 영구 저장소에 저장

2. **HTTP 폴링 방식**
  - 이유: 구현 단순성 및 안정성
  - WebSocket 대신 동적 폴링 주기로 부하 최소화

---

**Last Updated**: 2025-12-08  
**Version**: 1.0